<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»»åŠ¡è¿›åº¦</title>
    <link rel="stylesheet" href="/static/css/progress.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š ä»»åŠ¡è¿›åº¦</h1>
            <p>å®æ—¶æŸ¥çœ‹ä»»åŠ¡å®Œæˆæƒ…å†µ</p>
        </div>

        <div class="stats-section">
            <div class="stat-card">
                <div class="stat-number" id="totalTasks">{{ total_tasks }}</div>
                <div class="stat-label">æ€»ä»»åŠ¡</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="pendingTasks">{{ pending_tasks }}</div>
                <div class="stat-label">å¾…å®Œæˆ</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="completedTasks">{{ completed_tasks }}</div>
                <div class="stat-label">å·²å®Œæˆ</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="completionRate">{{ completion_rate }}%</div>
                <div class="stat-label">å®Œæˆç‡</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="overdueTasks">0</div>
                <div class="stat-label">é€¾æœŸä»»åŠ¡</div>
            </div>
        </div>

        <div class="tasks-section">
            <div class="section-header">
                <h2>ä»»åŠ¡åˆ—è¡¨</h2>
                <button id="addTaskBtn" class="add-task-btn">+ æ–°å¢ä»»åŠ¡</button>
            </div>
            <div id="tasksContainer">
                {% if tasks %}
                    <ul class="tasks-list">
                        <!-- ä¿®æ”¹ä»»åŠ¡é¡¹çš„è®¡æ—¶å™¨æ˜¾ç¤ºéƒ¨åˆ† -->
                        {% for task in tasks %}
                        <li class="task-item {{ 'completed' if task.completed else '' }} {{ 'timing' if task.is_timing else '' }}">
                            <input type="checkbox" class="task-checkbox" data-id="{{ task.id }}" {{ 'checked' if task.completed else '' }}>
                            <span class="task-title" data-id="{{ task.id }}">{{ task.title }}</span>
                            <div class="task-controls">
                                <input type="number" class="duration-input" data-id="{{ task.id }}" value="{{ task.duration }}" min="0">
                                <span class="timer-display" data-id="{{ task.id }}">{{ "%d:%02d" % (task.time_remaining|int, (task.time_remaining % 1 * 60)|int) }}</span>
                                <button class="start-timer-btn" data-id="{{ task.id }}">{{ 'æš‚åœ' if task.is_timing else 'å¼€å§‹' }}</button>
                                <button class="rename-btn" data-id="{{ task.id }}">é‡å‘½å</button>
                                <button class="delete-btn" data-id="{{ task.id }}">åˆ é™¤</button>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <div class="no-tasks">æš‚æ— ä»»åŠ¡</div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- æ·»åŠ ä»»åŠ¡å¼¹çª— -->
    <div id="addTaskModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h3>æ·»åŠ æ–°ä»»åŠ¡</h3>
            <input type="text" id="newTaskTitle" placeholder="ä»»åŠ¡åç§°" required>
            <input type="number" id="newTaskDuration" placeholder="é¢„è®¡æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰" min="1" required>
            <button id="confirmAddTask">æ·»åŠ </button>
        </div>
    </div>

    <!-- é‡å‘½åä»»åŠ¡å¼¹çª— -->
    <div id="renameTaskModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h3>é‡å‘½åä»»åŠ¡</h3>
            <input type="text" id="renameTaskTitle" placeholder="æ–°ä»»åŠ¡åç§°" required>
            <button id="confirmRenameTask">ç¡®è®¤</button>
        </div>
    </div>

    <script src="/static/js/progress.js"></script>
</body>
</html>